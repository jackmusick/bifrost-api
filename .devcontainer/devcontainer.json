{
  "name": "Bifrost API Development",
  "image": "mcr.microsoft.com/devcontainers/python:3.11-bullseye",

  "features": {
    "ghcr.io/devcontainers/features/azure-cli:1": {
      "version": "latest"
    },
    "ghcr.io/devcontainers/features/node:1": {
      "version": "20"
    }
  },

  "postCreateCommand": "pip install -r api/requirements.txt && npm install -g azure-functions-core-tools@4 azurite --unsafe-perm true",

  "forwardPorts": [7071, 4280, 10000, 10001, 10002],

  "customizations": {
    "vscode": {
      "extensions": [
        "ms-python.python",
        "ms-python.vscode-pylance",
        "ms-azuretools.vscode-azurefunctions",
        "charliermarsh.ruff",
        "dbaeumer.vscode-eslint",
        "Vue.volar"
      ],
      "settings": {
        "python.defaultInterpreterPath": "/usr/local/bin/python",
        "python.linting.enabled": true,
        "python.formatting.provider": "none",
        "[python]": {
          "editor.defaultFormatter": "charliermarsh.ruff",
          "editor.formatOnSave": true
        },
        "terminal.integrated.defaultProfile.linux": "bash"
      }
    }
  },

  "remoteUser": "vscode",

  "// Usage Instructions": {
    "1. Open in Codespaces": "Click 'Open in Codespaces' button in GitHub",
    "2. Start Azurite": "Run: azurite &",
    "3. Start Functions": "Run: cd api && func start",
    "4. Start SWA CLI": "Run: cd client && npm run dev",
    "5. Access": "Open forwarded port 4280 in browser"
  }
}